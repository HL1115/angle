<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Document</title>
    <style>
        *{
            padding: 0;
            margin: 0;
        }
        body{
            /* display: flex; */
            /* flex-direction: column; */
            writing-mode: vertical-rl;
        }
        #can{
            /* align-items: center; */
            background-color: #ccc;
            display: block;
        }
    </style>
</head>
<body>
    <canvas id="can"></canvas>
    <script>

            var can = document.querySelector('#can');
            var cxt = can.getContext('2d');
            var h = window.innerHeight;
            var w = window.innerWidth;
            can.height = h;
            can.width = w;
            var drag = false;

            function db(){
                cxt.beginPath();
                cxt.strokeStyle = "#aaa";
                cxt.arc(0,0,w-100,1/2*Math.PI,3/2*Math.PI,true);
                cxt.stroke()
                cxt.closePath();
                cxt.beginPath();
                cxt.fillStyle = "blue";
                cxt.arc(0,0,5,0,2*Math.PI,true);
                cxt.fill()
                cxt.closePath();
                cxt.beginPath();
                cxt.strokeStyle = "blue";
                
                cxt.textBaseline='middle';
                cxt.textAlign='center';
                cxt.font = 'bold 30px Arial';
                
                for(var i=1;i<181;i++){
                    cxt.beginPath();
                    cxt.save();
                    cxt.rotate(Math.PI/180*i);  
                    cxt.strokeStyle = "red";
                    if(i%10 === 0){
                        cxt.moveTo(0,-w+120)
                    }else if(i%5===0){
                        cxt.moveTo(0,-w+115)
                    }else{
                        cxt.moveTo(0,-w+110)

                    }
                    cxt.lineTo(0,-w+100);
                    cxt.stroke();
                    cxt.restore();
                    cxt.closePath();

                }
            }
            var n = 0;
            function draw(){
                cxt.save();
                cxt.rotate(Math.PI/180*n); 
                
                cxt.moveTo(0,0);
                cxt.lineTo(w-50,0);
                cxt.stroke();
                cxt.moveTo(w-75,0);
                cxt.arc(w-75,0,10,0,2*Math.PI)
                cxt.fill();
                cxt.restore();
                cxt.save();
                cxt.translate(w-150,0);
                cxt.rotate(0.5*Math.PI)
                cxt.fillText((90+n).toFixed(2),0,0); 
                cxt.restore();
            }
            function move(){
                cxt.clearRect(0,0,w,h);
                cxt.save()
                cxt.translate(0,h/2);
                // n++;
                db();
                draw();
                cxt.restore()
            }
            move()
            can.addEventListener('touchstart',function(e){
                var pX = e.touches[0].pageX,
                    pY = e.touches[0].pageY,
                    x = (w-75)*Math.cos(Math.abs(n)*Math.PI/180),
                    y = h/2 + (w-75)*Math.sin(n*Math.PI/180);
                    console.log(y,n)
                if(pX>x-10&&pX<x+10 &&pY<y+10 && pY>y-10){
                    drag = true;
                    // this.curr = e.touches[0].pageY;
                }
            })
            can.addEventListener('touchmove',function(e){
                if(!drag){
                    return;
                }
                // if(e.touches[0].pageY<this.curr){
                    var y = e.touches[0].pageY;
                    y = Math.abs(y-h/2)<(w-75)?y: y>h/2?(w-75+h/2):(h/2-w+75);
                   var d = Math.asin((y-h/2)/(w-75))/Math.PI*180;
                //    d = Math.abs(d)<1? ( d<0?d>-1&&-1:(d<1&&1) ):parseInt(d)
                    // this.curr = e.touches[0].pageY;
                    cxt.clearRect(0,0,w,h);
                    cxt.save()
                    cxt.translate(0,h/2);
                    n=d;
                    db();
                    draw();
                    cxt.restore()
            })
            can.addEventListener('touchend',function(e){
                drag = false;
            })
           
            
    </script>
    
</body>
</html>